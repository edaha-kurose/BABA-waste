// ============================================================================
// 店舗物品管理サンプルエクセルファイル生成スクリプト
// 作成日: 2025-09-16
// 目的: 添付画像の形式に基づく店舗物品管理サンプルエクセルファイルを生成
// ============================================================================

const XLSX = require('xlsx');
const path = require('path');
const fs = require('fs');

// 添付画像の形式に基づくサンプルデータ
const storeItemsData = [
  // ヘッダー行（A列からL列まで）
  ['店舗番号', 'エリア長コード', '店舗名', '舗名', '混載物', '蛍光灯', 'テスター', '商品管理ゲート', '未使用クレジット端末', 'ハンカチ什器', '野菜什器', 'リスト外対象物物品名'],
  
  // データ行（添付画像の形式に基づく）
  ['21487', '00208021', '稲元店', '福岡', '1', '10', '1', '0', '0', '1', '0', '液晶テレビ 1台'],
  ['19361', '00230883', '七重店', '福岡', '0', '5', '0', '0', '1', '0', '1', 'ラック、アルコールディスペンサー、レジガード用スタンド'],
  ['12345', '00212345', '宗像東郷店', '福岡', '2', '15', '1', '1', '0', '1', '1', '消去機 2台'],
  ['23456', '00223456', '岸の浦店', '福岡', '0', '8', '0', '0', '0', '0', '0', 'のぼり棒、掃除機の棒、ハートブラシの棒'],
  ['34567', '00234567', '茶屋の原店', '福岡', '1', '12', '1', '0', '1', '1', '0', 'テレビ 1台'],
  ['45678', '00245678', '岡垣吉木店', '福岡', '0', '6', '0', '1', '0', '0', '1', '合板止水版・4脚の台・パーテーション用スタンド・コンタクト陳列什器・レジ袋スタンド・募金箱'],
  ['56789', '00256789', '竹末店', '福岡', '1', '20', '1', '0', '0', '1', '1', '脚立、ラベラー、カート車輪、机6台、棒'],
  ['67890', '00267890', '春日台店', '福岡', '0', '7', '0', '0', '1', '0', '0', '飛沫防止、レジ用フィルター 吊り下げ什器 1本'],
  ['78901', '00278901', '鞍手店', '福岡', '2', '18', '1', '1', '0', '1', '1', 'ラック 2台、アルコールディスペンサー 1台'],
  ['89012', '00289012', 'くりえいと宗像店', '福岡', '0', '9', '0', '0', '0', '0', '0', 'テレビ 1台、ラック 1台'],
  ['90123', '00290123', '中鶴店', '福岡', '1', '11', '1', '0', '1', '1', '0', '消去機 1台、のぼり棒 2本'],
  ['01234', '00201234', '紅梅店', '福岡', '0', '4', '0', '0', '0', '0', '1', 'カート車輪 4個、机 2台'],
  ['12345', '00212345', '岡垣店', '福岡', '1', '16', '1', '1', '0', '1', '1', 'レジガード用スタンド 1台、募金箱 1個'],
  ['23456', '00223456', '水巻店', '福岡', '0', '13', '0', '0', '1', '0', '0', '飛沫防止フィルター 3枚、吊り下げ什器 1本'],
  ['34567', '00234567', '福岡宗像店', '福岡', '2', '22', '1', '1', '0', '1', '1', '脚立 1台、ラベラー 2台、カート車輪 6個'],
  ['45678', '00245678', '直方感田店', '福岡', '0', '14', '0', '0', '0', '0', '0', '机 4台、棒 3本'],
  ['56789', '00256789', '吉田南店', '福岡', '1', '17', '1', '0', '1', '1', '0', 'テレビ 1台、ラック 1台、アルコールディスペンサー 1台'],
  ['67890', '00267890', '中津熊店', '福岡', '0', '19', '0', '1', '0', '0', '1', '合板止水版 2枚、パーテーション用スタンド 1台'],
  ['78901', '00278901', '行橋京町店', '福岡', '1', '21', '1', '0', '0', '1', '1', 'コンタクト陳列什器 1台、レジ袋スタンド 1台'],
  ['89012', '00289012', '沼南店', '福岡', '0', '23', '0', '0', '1', '0', '0', '募金箱 1個、のぼり棒 1本'],
  ['90123', '00290123', '今川店', '福岡', '2', '25', '1', '1', '0', '1', '1', 'ハートブラシの棒 2本、掃除機の棒 1本'],
];

// ワークシートを作成
const worksheet = XLSX.utils.aoa_to_sheet(storeItemsData);

// 列幅を設定
const colWidths = [
  { wch: 10 }, // 店舗番号
  { wch: 12 }, // エリア長コード
  { wch: 15 }, // 店舗名
  { wch: 8 },  // 舗名
  { wch: 8 },  // 混載物
  { wch: 8 },  // 蛍光灯
  { wch: 8 },  // テスター
  { wch: 12 }, // 商品管理ゲート
  { wch: 15 }, // 未使用クレジット端末
  { wch: 12 }, // ハンカチ什器
  { wch: 10 }, // 野菜什器
  { wch: 40 }, // リスト外対象物物品名
];
worksheet['!cols'] = colWidths;

// ヘッダー行のスタイルを設定
const headerRange = XLSX.utils.decode_range(worksheet['!ref']);
for (let col = headerRange.s.c; col <= headerRange.e.c; col++) {
  const cellAddress = XLSX.utils.encode_cell({ r: 0, c: col });
  if (!worksheet[cellAddress]) continue;
  
  worksheet[cellAddress].s = {
    font: { bold: true },
    fill: { fgColor: { rgb: "E6F3FF" } },
    alignment: { horizontal: "center", vertical: "center" }
  };
}

// ワークブックを作成
const workbook = XLSX.utils.book_new();
XLSX.utils.book_append_sheet(workbook, worksheet, '店舗物品管理');

// 出力ディレクトリを作成
const outputDir = path.join(__dirname, '..', 'sample-data');
if (!fs.existsSync(outputDir)) {
  fs.mkdirSync(outputDir, { recursive: true });
}

// ファイルを保存
const outputPath = path.join(outputDir, '店舗物品管理サンプル.xlsx');
XLSX.writeFile(workbook, outputPath);

console.log('✅ 店舗物品管理サンプルエクセルファイルを生成しました:');
console.log(`📁 保存先: ${outputPath}`);
console.log(`📊 データ件数: ${storeItemsData.length - 1}件（ヘッダー除く）`);
console.log('');
console.log('📋 含まれるデータ:');
console.log('- 店舗: 稲元店、七重店、宗像東郷店、岸の浦店、茶屋の原店等');
console.log('- エリア: 福岡');
console.log('- 物品: 混載物、蛍光灯、テスター、商品管理ゲート、未使用クレジット端末、ハンカチ什器、野菜什器');
console.log('- リスト外対象物: 液晶テレビ、ラック、消去機、のぼり棒等');
console.log('');
console.log('💡 このファイルは添付画像の形式に基づいています');
