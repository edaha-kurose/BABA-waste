// ============================================================================
// 詳細サンプルエクセルファイル生成スクリプト
// 作成日: 2025-09-16
// 目的: より実践的なサンプルデータを含むエクセルファイルを生成
// ============================================================================

const XLSX = require('xlsx');
const path = require('path');
const fs = require('fs');

// より詳細なサンプルデータ
const detailedSampleData = [
  // ヘッダー行
  ['店舗コード', '店舗名', 'エリア', '回収日', '品目名', '数量', '単位', '備考', '担当者', '連絡先'],
  
  // データ行（より多様なパターンを含む）
  ['001', '本店', '渋谷区', '2025-09-20', '廃プラスチック', 2.5, 'T', '容器包装プラスチック', '田中太郎', '03-1234-5678'],
  ['002', '支店A', '新宿区', '2025-09-21', '古紙', 50, 'KG', '段ボール・新聞紙', '佐藤花子', '03-2345-6789'],
  ['003', '支店B', '港区', '2025-09-22', '金属くず', 1.2, 'T', '鉄くず・非鉄金属', '鈴木一郎', '03-3456-7890'],
  ['001', '本店', '渋谷区', '2025-09-23', '廃油', 200, 'L', '天ぷら油・潤滑油', '田中太郎', '03-1234-5678'],
  ['004', '支店C', '品川区', '2025-09-24', '廃プラスチック', 1.8, 'T', '容器包装プラスチック', '高橋美咲', '03-4567-8901'],
  ['002', '支店A', '新宿区', '2025-09-25', '古紙', 75, 'KG', '段ボール・雑誌', '佐藤花子', '03-2345-6789'],
  ['005', '支店D', '目黒区', '2025-09-26', '金属くず', 0.8, 'T', '鉄くず・アルミ缶', '山田次郎', '03-5678-9012'],
  ['003', '支店B', '港区', '2025-09-27', '廃油', 150, 'L', '天ぷら油', '鈴木一郎', '03-3456-7890'],
  ['001', '本店', '渋谷区', '2025-09-28', '廃プラスチック', 3.2, 'T', '容器包装プラスチック', '田中太郎', '03-1234-5678'],
  ['004', '支店C', '品川区', '2025-09-29', '古紙', 60, 'KG', '段ボール・新聞紙', '高橋美咲', '03-4567-8901'],
  ['005', '支店D', '目黒区', '2025-09-30', '廃油', 180, 'L', '天ぷら油・潤滑油', '山田次郎', '03-5678-9012'],
  ['002', '支店A', '新宿区', '2025-10-01', '廃プラスチック', 2.1, 'T', '容器包装プラスチック', '佐藤花子', '03-2345-6789'],
  ['003', '支店B', '港区', '2025-10-02', '古紙', 45, 'KG', '段ボール・新聞紙', '鈴木一郎', '03-3456-7890'],
  ['001', '本店', '渋谷区', '2025-10-03', '金属くず', 1.5, 'T', '鉄くず・非鉄金属', '田中太郎', '03-1234-5678'],
  ['004', '支店C', '品川区', '2025-10-04', '廃油', 220, 'L', '天ぷら油・潤滑油', '高橋美咲', '03-4567-8901'],
  ['005', '支店D', '目黒区', '2025-10-05', '廃プラスチック', 1.9, 'T', '容器包装プラスチック', '山田次郎', '03-5678-9012'],
  ['002', '支店A', '新宿区', '2025-10-06', '古紙', 80, 'KG', '段ボール・雑誌', '佐藤花子', '03-2345-6789'],
  ['003', '支店B', '港区', '2025-10-07', '金属くず', 1.0, 'T', '鉄くず・アルミ缶', '鈴木一郎', '03-3456-7890'],
  ['001', '本店', '渋谷区', '2025-10-08', '廃油', 190, 'L', '天ぷら油', '田中太郎', '03-1234-5678'],
  ['004', '支店C', '品川区', '2025-10-09', '廃プラスチック', 2.8, 'T', '容器包装プラスチック', '高橋美咲', '03-4567-8901'],
  ['005', '支店D', '目黒区', '2025-10-10', '古紙', 55, 'KG', '段ボール・新聞紙', '山田次郎', '03-5678-9012'],
  ['001', '本店', '渋谷区', '2025-10-11', '金属くず', 1.3, 'T', '鉄くず・非鉄金属', '田中太郎', '03-1234-5678'],
  ['002', '支店A', '新宿区', '2025-10-12', '廃油', 210, 'L', '天ぷら油・潤滑油', '佐藤花子', '03-2345-6789'],
  ['003', '支店B', '港区', '2025-10-13', '廃プラスチック', 2.4, 'T', '容器包装プラスチック', '鈴木一郎', '03-3456-7890'],
  ['004', '支店C', '品川区', '2025-10-14', '古紙', 70, 'KG', '段ボール・新聞紙', '高橋美咲', '03-4567-8901'],
  ['005', '支店D', '目黒区', '2025-10-15', '金属くず', 0.9, 'T', '鉄くず・アルミ缶', '山田次郎', '03-5678-9012'],
  ['001', '本店', '渋谷区', '2025-10-16', '廃油', 170, 'L', '天ぷら油', '田中太郎', '03-1234-5678'],
  ['002', '支店A', '新宿区', '2025-10-17', '廃プラスチック', 2.6, 'T', '容器包装プラスチック', '佐藤花子', '03-2345-6789'],
  ['003', '支店B', '港区', '2025-10-18', '古紙', 65, 'KG', '段ボール・雑誌', '鈴木一郎', '03-3456-7890'],
  ['004', '支店C', '品川区', '2025-10-19', '金属くず', 1.1, 'T', '鉄くず・非鉄金属', '高橋美咲', '03-4567-8901'],
  ['005', '支店D', '目黒区', '2025-10-20', '廃油', 195, 'L', '天ぷら油・潤滑油', '山田次郎', '03-5678-9012'],
];

// ワークシートを作成
const worksheet = XLSX.utils.aoa_to_sheet(detailedSampleData);

// 列幅を設定
const colWidths = [
  { wch: 10 }, // 店舗コード
  { wch: 15 }, // 店舗名
  { wch: 12 }, // エリア
  { wch: 12 }, // 回収日
  { wch: 20 }, // 品目名
  { wch: 8 },  // 数量
  { wch: 8 },  // 単位
  { wch: 25 }, // 備考
  { wch: 12 }, // 担当者
  { wch: 15 }, // 連絡先
];
worksheet['!cols'] = colWidths;

// ヘッダー行のスタイルを設定
const headerRange = XLSX.utils.decode_range(worksheet['!ref']);
for (let col = headerRange.s.c; col <= headerRange.e.c; col++) {
  const cellAddress = XLSX.utils.encode_cell({ r: 0, c: col });
  if (!worksheet[cellAddress]) continue;
  
  worksheet[cellAddress].s = {
    font: { bold: true },
    fill: { fgColor: { rgb: "E6F3FF" } },
    alignment: { horizontal: "center", vertical: "center" }
  };
}

// ワークブックを作成
const workbook = XLSX.utils.book_new();
XLSX.utils.book_append_sheet(workbook, worksheet, '予定データ');

// 出力ディレクトリを作成
const outputDir = path.join(__dirname, '..', 'sample-data');
if (!fs.existsSync(outputDir)) {
  fs.mkdirSync(outputDir, { recursive: true });
}

// ファイルを保存
const outputPath = path.join(outputDir, '予定データ詳細サンプル.xlsx');
XLSX.writeFile(workbook, outputPath);

console.log('✅ 詳細サンプルエクセルファイルを生成しました:');
console.log(`📁 保存先: ${outputPath}`);
console.log(`📊 データ件数: ${detailedSampleData.length - 1}件（ヘッダー除く）`);
console.log('');
console.log('📋 含まれるデータ:');
console.log('- 店舗: 本店、支店A、支店B、支店C、支店D');
console.log('- エリア: 渋谷区、新宿区、港区、品川区、目黒区');
console.log('- 品目: 廃プラスチック、古紙、金属くず、廃油');
console.log('- 単位: T（トン）、KG（キログラム）、L（リットル）');
console.log('- 期間: 2025年9月20日〜10月20日');
console.log('- 追加項目: 担当者、連絡先');
console.log('');
console.log('💡 このファイルは実際の業務データにより近い形式です');

