# Global Development Rules for All Projects

**ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯CursorãŒè‡ªå‹•çš„ã«èª­ã¿è¾¼ã¿ã¾ã™ã€‚å…¨ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…±é€šã®ãƒ«ãƒ¼ãƒ«ã§ã™ã€‚**

---

## ğŸ’° ã‚³ã‚¹ãƒˆæœ€é©åŒ–ï¼ˆæœ€å„ªå…ˆãƒ«ãƒ¼ãƒ«ï¼‰

**å‡ºåŠ›ãƒˆãƒ¼ã‚¯ãƒ³å‰Šæ¸›ã®ãŸã‚ã€ä»¥ä¸‹ã‚’å³å®ˆ**:

1. **ç°¡æ½”ãªå¿œç­”**
   - èª¬æ˜ã¯æœ€å°é™ï¼ˆ2ã€œ3æ–‡ï¼‰
   - ã‚³ãƒ¼ãƒ‰ä¾‹ã¯å¿…è¦ç®‡æ‰€ã®ã¿ï¼ˆ5ã€œ10è¡Œï¼‰
   - å†—é•·ãªå‰ç½®ããƒ»ã¾ã¨ã‚ã¯ä¸è¦

2. **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆè‡ªå‹•ç”Ÿæˆã‚’åˆ¶é™**
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ˜ç¤ºçš„ã«è¦æ±‚ã—ãŸå ´åˆã®ã¿
   - ç®‡æ¡æ›¸ãã§ç°¡æ½”ã«

3. **çµµæ–‡å­—ãƒ»è£…é£¾ã‚’å‰Šæ¸›**
   - çµµæ–‡å­—ã¯1ã€œ2å€‹ã¾ã§
   - ç½«ç·šãƒ»è£…é£¾ã¯ä¸è¦

4. **å‡ºåŠ›ã®ç›®å®‰**: æ—¥æœ¬èª200ã€œ400æ–‡å­—ä»¥å†…

---

## ğŸ“‹ ç°¡æ½”ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæˆ¦ç•¥ï¼ˆå¿…é ˆï¼‰

**ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç”Ÿæˆæ™‚ã¯ä»¥ä¸‹ã®å½¢å¼ã§æœ€å°åŒ–**:

### åŸºæœ¬æ§‹é€ ï¼ˆ3ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ã¿ï¼‰
```markdown
# æ©Ÿèƒ½å

## æ¦‚è¦
- ç›®çš„: 1æ–‡ã§
- ä½¿ã„æ–¹: 3ã‚¹ãƒ†ãƒƒãƒ—ä»¥å†…

## è¨­å®š
| é …ç›® | å€¤ | å‚™è€ƒ |
|------|-----|------|
| ç’°å¢ƒå¤‰æ•° | XXX | å¿…é ˆ/ä»»æ„ |

## ãƒ†ã‚¹ãƒˆ
- [ ] åŸºæœ¬å‹•ä½œ
- [ ] ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹
```

### ç¦æ­¢äº‹é …
- âŒ é•·æ–‡ã®èª¬æ˜ï¼ˆ5è¡Œä»¥ä¸Šï¼‰
- âŒ è©³ç´°ãªèƒŒæ™¯èª¬æ˜
- âŒ å†—é•·ãªã‚³ãƒ¼ãƒ‰ä¾‹ï¼ˆ10è¡Œä»¥ä¸Šï¼‰
- âŒ ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ
- âŒ è©³ç´°ãªæŠ€è¡“è§£èª¬

### è¨±å¯äº‹é …
- âœ… ãƒ†ãƒ¼ãƒ–ãƒ«å½¢å¼ã®æƒ…å ±æ•´ç†
- âœ… ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ
- âœ… æœ€å°é™ã®ã‚³ãƒ¼ãƒ‰ä¾‹ï¼ˆ5ã€œ10è¡Œï¼‰

---

## ğŸ¯ é–‹ç™ºé–‹å§‹æ™‚ã®å¿…é ˆãƒã‚§ãƒƒã‚¯

### Phase 0: å®Ÿè£…å‰ç¢ºèªï¼ˆASKåˆ¤æ–­ï¼‰

å®Ÿè£…é–‹å§‹å‰ã«ä»¥ä¸‹ã‚’ç¢ºèªã—ã€**1ã¤ã§ã‚‚ä¸æ˜ãªã‚‰ASKã§è³ªå•**:

- [ ] ãƒ†ãƒ¼ãƒ–ãƒ«/åˆ—/ENUM/JOINã‚­ãƒ¼ã¯ç¢ºå®šã—ã¦ã„ã‚‹ã‹ï¼Ÿ
- [ ] RLSå¢ƒç•Œã¯æ˜ç¢ºã‹ï¼Ÿ
- [ ] å½±éŸ¿åº¦ã¯LOW/MEDIUMã‹ï¼Ÿï¼ˆHIGH+ãªã‚‰å¿…ãšASKï¼‰
- [ ] **schema.prisma ã¨ DB ã¯åŒæœŸã—ã¦ã„ã‚‹ã‹ï¼Ÿ** (`pnpm check:schema-sync`)
- [ ] **å¤–éƒ¨ã‚­ãƒ¼åˆ¶ç´„ã¯é©åˆ‡ã‹ï¼Ÿ** (`pnpm check:foreign-keys`)

### å¿…é ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆèª­ã¿è¾¼ã¿

æ–°è¦ã‚¿ã‚¹ã‚¯é–‹å§‹æ™‚ã¯ä»¥ä¸‹ã‚’é †ç•ªã«èª­ã¿è¾¼ã‚“ã§ãã ã•ã„:

1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã® `.cursorrules` ã‚’ç¢ºèª
2. `docs/guardrails/` é…ä¸‹ã‚’å‚ç…§
   - **Prismaãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ™‚**: `PRISMA_MIGRATION_GUIDE.md` ã‚’å¿…ãšç¢ºèª
   - **ã‚¹ã‚­ãƒ¼ãƒå¤‰æ›´æ™‚**: `SCHEMA_CHANGE_GUIDELINES.md`
   - **ã‚¤ãƒ³ãƒ•ãƒ©è¨­å®šæ™‚**: `INFRASTRUCTURE_SETUP_CHECKLIST.md`
3. `docs/runbooks/_prompt-kickoff.md` ã«å¾“ã†

---

## ğŸ—„ï¸ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œã®çµ¶å¯¾ãƒ«ãƒ¼ãƒ«

### A. ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æ“ä½œã®åŸå‰‡

**âŒ ç¦æ­¢äº‹é …**:
1. é–¢é€£ãƒ†ãƒ¼ãƒ–ãƒ«ã¸ã®ç›´æ¥ INSERT/DELETE/UPDATE
2. è¤‡æ•°ãƒ†ãƒ¼ãƒ–ãƒ«ã«è·¨ã‚‹ãƒ‡ãƒ¼ã‚¿ã®éƒ¨åˆ†çš„å‰Šé™¤ï¼ˆæ•´åˆæ€§å´©å£Šï¼‰
3. å¤–éƒ¨ã‚­ãƒ¼åˆ¶ç´„ã‚’ç„¡è¦–ã—ãŸå‰Šé™¤ï¼ˆå­â†’è¦ªã®é †åºå³å®ˆï¼‰
4. ä¸€æ„åˆ¶ç´„ã‚’ç„¡è¦–ã—ãŸé‡è¤‡ãƒ‡ãƒ¼ã‚¿ä½œæˆ

**âœ… å¿…é ˆäº‹é …**:
1. æ“ä½œå‰ã«æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯ï¼ˆé‡è¤‡ãƒ»å­¤ç«‹ãƒ‡ãƒ¼ã‚¿ã®ç¢ºèªï¼‰
2. å°‚ç”¨ã®å®‰å…¨ãªã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ»é–¢æ•°ã‚’ä½¿ç”¨
3. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰ã®æ‰‹é †æ›¸ã«å¾“ã†

### B. å¤–éƒ¨ã‚­ãƒ¼åˆ¶ç´„ã®å¿…é ˆç¢ºèª

**æ–°ã—ã„ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆæ™‚**:
```sql
-- âŒ æ‚ªã„ä¾‹ï¼ˆå‹•ä½œæœªå®šç¾©ï¼‰
FOREIGN KEY (parent_id) REFERENCES parent_table(id)

-- âœ… è‰¯ã„ä¾‹ï¼ˆã‚«ã‚¹ã‚±ãƒ¼ãƒ‰å‹•ä½œã‚’æ˜ç¤ºï¼‰
FOREIGN KEY (parent_id) REFERENCES parent_table(id) 
  ON DELETE CASCADE  -- è¦ªå‰Šé™¤æ™‚ã«å­ã‚‚å‰Šé™¤
  ON UPDATE CASCADE  -- è¦ªæ›´æ–°æ™‚ã«å­ã‚‚æ›´æ–°
```

**AIå®Ÿè£…æ™‚ã®ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ**:
- [ ] å¤–éƒ¨ã‚­ãƒ¼åˆ¶ç´„ã« `ON DELETE`/`ON UPDATE` ã‚’æ˜ç¤º
- [ ] ä¸€æ„åˆ¶ç´„ï¼ˆUNIQUEï¼‰ã®è¨­å®šã‚’ç¢ºèª
- [ ] é–¢é€£ãƒ†ãƒ¼ãƒ–ãƒ«é–“ã®æ•´åˆæ€§ã‚’ç¢ºèª

### C. Seed/Reset æ“ä½œã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å¿…é ˆ

```sql
-- âœ… æ­£ã—ã„ãƒ‘ã‚¿ãƒ¼ãƒ³
BEGIN;
  -- Step 1: å­ãƒ†ãƒ¼ãƒ–ãƒ«å‰Šé™¤ï¼ˆå¤–éƒ¨ã‚­ãƒ¼é †åºï¼‰
  DELETE FROM child_table WHERE parent_id IN (...);
  
  -- Step 2: è¦ªãƒ†ãƒ¼ãƒ–ãƒ«å‰Šé™¤
  DELETE FROM parent_table WHERE id = '...';
  
  -- Step 3: é–¢é€£ãƒ†ãƒ¼ãƒ–ãƒ«ã‚‚å‰Šé™¤
  DELETE FROM related_table WHERE key = '...';
  
  -- Step 4: å†ä½œæˆ
  INSERT INTO ...;
COMMIT;

-- âŒ é–“é•ã£ãŸãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç„¡ã—ï¼‰
DELETE FROM users ...;  -- ã“ã‚Œã ã‘ã ã¨æ•´åˆæ€§ãŒå´©ã‚Œã‚‹
```

---

## ğŸ—„ï¸ Prisma å¿…é ˆãƒ«ãƒ¼ãƒ«ï¼ˆCRITICALï¼‰

**ã“ã‚Œã‚‰ã®ãƒ«ãƒ¼ãƒ«ã¯ã€Œcollectors ãƒ†ãƒ¼ãƒ–ãƒ«ä¸æ•´åˆå•é¡Œã€ã‹ã‚‰å¾—ã‚‰ã‚ŒãŸæ•™è¨“ã§ã™ã€‚**  
**è©³ç´°**: `docs/POST_MORTEM_COLLECTORS_TABLE_ISSUE.md`

### A. ã‚¹ã‚­ãƒ¼ãƒåŒæœŸã®çµ¶å¯¾åŸå‰‡

**å®Ÿè£…å‰ã«å¿…ãšå®Ÿè¡Œ**:
```bash
# schema.prisma ã¨ DB ã®åŒæœŸç¢ºèª
pnpm check:schema-sync
```

**ãƒ«ãƒ¼ãƒ«**:
- [ ] `pnpm check:schema-sync` ã‚’å®Ÿè£…å‰ã«å¿…ãšå®Ÿè¡Œ
- [ ] `prisma db pull` ã‚’å®šæœŸçš„ã«å®Ÿè¡Œï¼ˆé€±1å›æ¨å¥¨ï¼‰
- [ ] schema.prisma ç·¨é›†å¾Œã¯å¿…ãš `prisma migrate dev` å®Ÿè¡Œ
- [ ] æ‰‹å‹•SQLã¨ã®ä½µç”¨ã¯åŸå‰‡ç¦æ­¢ï¼ˆPrisma Migrate ã«çµ±ä¸€ï¼‰

**âŒ ç¦æ­¢ãƒ‘ã‚¿ãƒ¼ãƒ³**:
```typescript
// schema.prisma ã ã‘ç·¨é›†ã—ã¦DBã«åæ˜ ã—ãªã„
model new_table {
  id String @id
}
// â†’ pnpm prisma migrate dev ã‚’å®Ÿè¡Œã›ãšå®Ÿè£…é–‹å§‹ â† çµ¶å¯¾NG
```

**âœ… æ­£ã—ã„ãƒ‘ã‚¿ãƒ¼ãƒ³**:
```bash
# Step 1: ã‚¹ã‚­ãƒ¼ãƒåŒæœŸç¢ºèª
pnpm check:schema-sync

# Step 2: schema.prisma ç·¨é›†

# Step 3: ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
pnpm prisma migrate dev --name descriptive_name

# Step 4: å‹ç”Ÿæˆ
pnpm prisma:generate
```

---

### B. å¤–éƒ¨ã‚­ãƒ¼åˆ¶ç´„ã®å¿…é ˆåŒ–

**ãƒ«ãƒ¼ãƒ«**:
- `*_id` ã‚«ãƒ©ãƒ ã«ã¯ **å¿…ãš** å¤–éƒ¨ã‚­ãƒ¼åˆ¶ç´„ã‚’è¿½åŠ 
- `ON DELETE` / `ON UPDATE` ã®å‹•ä½œã‚’ **æ˜ç¤º**
- schema.prisma ã§ `@relation` ã‚’ **å¿…ãš** å®šç¾©

**âŒ ç¦æ­¢ãƒ‘ã‚¿ãƒ¼ãƒ³**:
```prisma
model child_table {
  id        String @id
  parent_id String @db.Uuid  // â† å¤–éƒ¨ã‚­ãƒ¼åˆ¶ç´„ãªã— = NG
}
```

**âœ… æ­£ã—ã„ãƒ‘ã‚¿ãƒ¼ãƒ³**:
```prisma
model child_table {
  id           String       @id
  parent_id    String       @db.Uuid
  parent_table parent_table @relation(fields: [parent_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  
  @@index([parent_id])
}

model parent_table {
  id            String        @id
  child_tables  child_table[]
}
```

**SQL DDL ã§ã®æ˜ç¤º**:
```sql
-- âœ… æ­£ã—ã„ä¾‹ï¼ˆå‹•ä½œã‚’æ˜ç¤ºï¼‰
ALTER TABLE app.child_table
ADD CONSTRAINT fk_child_parent
  FOREIGN KEY (parent_id)
  REFERENCES app.parent_table (id)
  ON DELETE CASCADE    -- è¦ªå‰Šé™¤æ™‚ã«å­ã‚‚å‰Šé™¤
  ON UPDATE NO ACTION; -- è¦ªæ›´æ–°æ™‚ã¯ä½•ã‚‚ã—ãªã„
```

**ãƒã‚§ãƒƒã‚¯ã‚³ãƒãƒ³ãƒ‰**:
```bash
pnpm check:foreign-keys
```

---

### C. ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æˆ¦ç•¥ã®çµ±ä¸€

**æ¨™æº–**: Prisma Migrate ã‚’æ¡ç”¨

**âŒ ç¦æ­¢**:
```bash
# æ‰‹å‹•SQLã§ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ
psql $DATABASE_URL -f db/migrations/001_create_table.sql
```

**âœ… æ­£è§£**:
```bash
# Prisma Migrate ã‚’ä½¿ç”¨
pnpm prisma migrate dev --name create_table
```

**ä¾‹å¤–ï¼ˆæ‰‹å‹•SQLè¨±å¯ï¼‰**:
1. RLS ãƒãƒªã‚·ãƒ¼è¿½åŠ 
2. ã‚¹ãƒˆã‚¢ãƒ‰ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ä½œæˆ
3. å¤§é‡ãƒ‡ãƒ¼ã‚¿ç§»è¡Œ

**ä¾‹å¤–æ™‚ã®å¿…é ˆæ‰‹é †**:
```bash
# 1. æ‰‹å‹•SQLå®Ÿè¡Œå¾Œ
psql $DATABASE_URL -f custom.sql

# 2. ã‚¹ã‚­ãƒ¼ãƒåŒæœŸç¢ºèªï¼ˆå¿…é ˆï¼‰
pnpm check:schema-sync

# 3. å·®åˆ†ãŒã‚ã‚Œã° schema.prisma ã‚’æ›´æ–°
pnpm prisma db pull

# 4. å‹ç”Ÿæˆ
pnpm prisma:generate
```

---

## ğŸ” Next.js Middleware & èªè¨¼ãƒ«ãƒ¼ãƒ«ï¼ˆCRITICALï¼‰

**ã“ã‚Œã‚‰ã®ãƒ«ãƒ¼ãƒ«ã¯ã€ŒMiddlewareèªè¨¼å•é¡Œã€ã‹ã‚‰å¾—ã‚‰ã‚ŒãŸæ•™è¨“ã§ã™ã€‚**  
**è©³ç´°**: `docs/POST_MORTEM_MIDDLEWARE_AUTH_ISSUE.md`

### A. Next.js Middlewareã®é…ç½®ï¼ˆçµ¶å¯¾å³å®ˆï¼‰

**ãƒ«ãƒ¼ãƒ«**:
- Middlewareã¯**å¿…ãš**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆç›´ä¸‹ï¼ˆ`middleware.ts`ï¼‰ã«é…ç½®
- `src/middleware.ts`ã«ã¯é…ç½®ã—ãªã„ï¼ˆNext.jsãŒèªè­˜ã—ãªã„ï¼‰
- é…ç½®ã‚’èª¤ã‚‹ã¨MiddlewareãŒå®Ÿè¡Œã•ã‚Œãšã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒªã‚¹ã‚¯ã«ãªã‚‹

**âŒ ç¦æ­¢ãƒ‘ã‚¿ãƒ¼ãƒ³**:
```
next-app/src/middleware.ts  â† Next.jsãŒèªè­˜ã—ãªã„
```

**âœ… æ­£ã—ã„ãƒ‘ã‚¿ãƒ¼ãƒ³**:
```
next-app/middleware.ts      â† Next.jsãŒè‡ªå‹•èªè­˜
```

**ç¢ºèªã‚³ãƒãƒ³ãƒ‰**:
```bash
# Middlewareãƒ•ã‚¡ã‚¤ãƒ«ã®å­˜åœ¨ç¢ºèª
ls -la middleware.ts  # â† ã“ã‚ŒãŒå­˜åœ¨ã™ã¹ã
ls -la src/middleware.ts  # â† ã“ã‚Œã¯å­˜åœ¨ã—ã¦ã¯ã„ã‘ãªã„
```

**ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ**:
- [ ] Middlewareã¯`middleware.ts`ï¼ˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆç›´ä¸‹ï¼‰ã«é…ç½®
- [ ] `src/middleware.ts`ã«ã¯é…ç½®ã—ãªã„
- [ ] `config.matcher`ã‚’æ­£ã—ãè¨­å®š
- [ ] å…¬é–‹ãƒ‘ã‚¹ï¼ˆ`/login`, `/_next/*`ç­‰ï¼‰ã‚’é™¤å¤–

---

### B. Supabase SSRèªè¨¼ã®å®Œå…¨å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³

**ãƒ«ãƒ¼ãƒ«**:
- ã‚¯ãƒƒã‚­ãƒ¼ã‚¢ãƒ€ãƒ—ã‚¿ã®`get`/`set`/`remove`ã‚’**å®Œå…¨å®Ÿè£…**
- ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å†ç”Ÿæˆå¿…é ˆ
- ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¨ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ä¸¡æ–¹ã«ã‚¯ãƒƒã‚­ãƒ¼ã‚’è¨­å®š

**âŒ ç¦æ­¢ãƒ‘ã‚¿ãƒ¼ãƒ³**:
```typescript
// ä¸å®Œå…¨ãªå®Ÿè£…
const supabase = createServerClient(url, key, {
  cookies: {
    get(name) { return request.cookies.get(name)?.value },
    set() {},  // â† ä½•ã‚‚ã—ãªã„ = NG
    remove() {} // â† ä½•ã‚‚ã—ãªã„ = NG
  }
})
```

**âœ… æ­£ã—ã„ãƒ‘ã‚¿ãƒ¼ãƒ³**:
```typescript
let response = NextResponse.next({ request: { headers: request.headers } })

const supabase = createServerClient(url, key, {
  cookies: {
    get(name: string) {
      return request.cookies.get(name)?.value
    },
    set(name: string, value: string, options: any) {
      request.cookies.set({ name, value, ...options })
      response = NextResponse.next({ request: { headers: request.headers } })
      response.cookies.set({ name, value, ...options })
    },
    remove(name: string, options: any) {
      request.cookies.set({ name, value: '', ...options })
      response = NextResponse.next({ request: { headers: request.headers } })
      response.cookies.set({ name, value: '', ...options })
    },
  },
})

return response // â† å¿…ãšè¿”ã™
```

---

### C. E2Eãƒ†ã‚¹ãƒˆã®å®‰å®šåŒ–æˆ¦ç•¥

**ãƒ«ãƒ¼ãƒ«**:
1. **E2Eå°‚ç”¨ãƒã‚¤ãƒ‘ã‚¹**: èªè¨¼ãƒã‚§ãƒƒã‚¯ã‚’ã‚¹ã‚­ãƒƒãƒ—ã™ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å®Ÿè£…
2. **ã‚»ãƒƒã‚·ãƒ§ãƒ³ç¢ºç«‹å¾…æ©Ÿ**: `waitForTimeout(3000)`ã‚’æŒ¿å…¥
3. **ãƒªãƒˆãƒ©ã‚¤æˆ¦ç•¥**: `retries: 1`ã‚’è¨­å®š
4. **ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆèª¿æ•´**: èªè¨¼ãƒ•ãƒ­ãƒ¼ã¯é€šå¸¸ã‚ˆã‚Šé•·ã‚ã«è¨­å®š

**E2Eå°‚ç”¨ãƒã‚¤ãƒ‘ã‚¹å®Ÿè£…ä¾‹**:
```typescript
// middleware.ts
export async function middleware(request: NextRequest) {
  const { searchParams } = request.nextUrl

  // E2Eãƒã‚¤ãƒ‘ã‚¹ï¼ˆæœ¬ç•ªå½±éŸ¿ãªã—ï¼‰
  if (searchParams.get('e2e') === '1') {
    return NextResponse.next()
  }

  // é€šå¸¸ã®èªè¨¼ãƒã‚§ãƒƒã‚¯
  const supabase = createServerClient(...)
  const { data: { session } } = await supabase.auth.getSession()
  
  if (!session && pathname.startsWith('/dashboard')) {
    return NextResponse.redirect(new URL('/login', request.url))
  }

  return response
}
```

**E2Eãƒ†ã‚¹ãƒˆå´**:
```typescript
test('ãƒ­ã‚°ã‚¤ãƒ³ - Admin', async ({ page }) => {
  await page.goto('/login?e2e=1') // â† ãƒã‚¤ãƒ‘ã‚¹æœ‰åŠ¹åŒ–
  await page.click('button:has-text("ğŸ‘¤ ç®¡ç†è€…ã§ãƒ­ã‚°ã‚¤ãƒ³")')
  await page.waitForTimeout(3000) // ã‚»ãƒƒã‚·ãƒ§ãƒ³ç¢ºç«‹å¾…æ©Ÿ
  await page.waitForURL('/dashboard', { timeout: 15000 })
})
```

**Playwrightè¨­å®šä¾‹**:
```typescript
export default defineConfig({
  retries: process.env.CI ? 2 : 1,
  workers: process.env.CI ? 1 : 4,
  timeout: 60000,
  use: {
    baseURL: 'http://localhost:3000',
    actionTimeout: 15000,
    navigationTimeout: 30000,
  },
})
```

---

### D. Middlewareå®Ÿè£…ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

**å®Ÿè£…å‰**:
- [ ] Middlewareã®é…ç½®å ´æ‰€ã‚’ç¢ºèªï¼ˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆç›´ä¸‹ï¼‰
- [ ] Supabase SSRã‚¯ãƒƒã‚­ãƒ¼ã‚¢ãƒ€ãƒ—ã‚¿ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’æº–å‚™
- [ ] E2Eå°‚ç”¨ãƒã‚¤ãƒ‘ã‚¹ã‚’è¨­è¨ˆ

**å®Ÿè£…ä¸­**:
- [ ] ã‚¯ãƒƒã‚­ãƒ¼ã‚¢ãƒ€ãƒ—ã‚¿ã®`get`/`set`/`remove`ã‚’å®Œå…¨å®Ÿè£…
- [ ] å…¬é–‹ãƒ‘ã‚¹ï¼ˆ`/login`, `/_next/*`ï¼‰ã‚’é™¤å¤–
- [ ] `config.matcher`ã‚’æ­£ã—ãè¨­å®š

**å®Ÿè£…å¾Œ**:
- [ ] æ‰‹å‹•ã§ãƒ­ã‚°ã‚¤ãƒ³ â†’ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰é·ç§»ã‚’ç¢ºèª
- [ ] E2Eãƒ†ã‚¹ãƒˆã‚’å…¨ã¦å®Ÿè¡Œï¼ˆå…¨ãƒ–ãƒ©ã‚¦ã‚¶ï¼‰
- [ ] Middlewareã®ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°ã‚’ç¢ºèª
- [ ] ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¯ãƒƒã‚­ãƒ¼ãŒæ­£ã—ãä¿å­˜ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

---

## ğŸ“ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ï¼ˆå¿…é ˆæº–æ‹ ï¼‰

```yaml
required_stack:
  bff: "Next.js 14+ App Router"
  orm: "Prisma 5+"              # â† å¿…é ˆï¼ˆSupabaseç›´æ¥ã‚¯ã‚¨ãƒªç¦æ­¢ï¼‰
  database: "Supabase PostgreSQL"
  validation: "Zod"
  api_spec: "OpenAPI 3.1"
  testing:
    - "Vitest (unit)"
    - "Playwright (e2e)"

prohibited:
  - "Direct Supabase queries from frontend"
  - "Raw SQL without Prisma in BFF layer"
  - "Manual type definitions (use codegen)"
  - "Text type for ID columns (use UUID)"
```

---

## ğŸ”§ å¿…é ˆè‡ªå‹•åŒ–ã‚³ãƒãƒ³ãƒ‰

é–‹ç™ºæ™‚ã¯å¿…ãšä»¥ä¸‹ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„:

```bash
# å½±éŸ¿ç¯„å›²åˆ†æï¼ˆã‚¹ã‚­ãƒ¼ãƒå¤‰æ›´æ™‚ï¼‰
pnpm schema:impact -- --table <table_name>

# Preflightè¨ºæ–­ï¼ˆå®Ÿè£…å‰ï¼‰
pnpm -C tools/orchestrator scan

# å‹ç”Ÿæˆï¼ˆã‚¹ã‚­ãƒ¼ãƒå¤‰æ›´å¾Œï¼‰
pnpm gen:db-types && pnpm codegen

# Prisma ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
pnpm prisma:migrate
pnpm prisma:generate
```

---

## ğŸš« çµ¶å¯¾ç¦æ­¢äº‹é …ï¼ˆREFUSEï¼‰

ä»¥ä¸‹ã®å ´åˆã¯**å®Ÿè£…ã‚’æ‹’å¦**ã—ã€ä»£æ›¿æ¡ˆã‚’æç¤ºã—ã¦ãã ã•ã„:

1. âŒ **æ—¢å­˜DDLã®ç›´æ¥ç·¨é›†**ï¼ˆALTER TABLE ... MODIFYç­‰ï¼‰
   - å¯¾å¿œ: è¿½åŠ å¼DDLï¼ˆALTER TABLE ... ADD COLUMN IF NOT EXISTSï¼‰

2. âŒ **RLS OFFé•·æ™‚é–“**ï¼ˆ1ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³è¶…éï¼‰
   - å¯¾å¿œ: çŸ­æ™‚é–“OFFâ†’å³ONï¼ˆåŒä¸€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å†…ï¼‰

3. âŒ **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¸ã®ç§˜å¯†éµéœ²å‡º**ï¼ˆJWNET_API_KEYç­‰ï¼‰
   - å¯¾å¿œ: ç’°å¢ƒå¤‰æ•°ã¯ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã®ã¿ï¼ˆNEXT_PUBLIC_ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ãªã—ï¼‰

4. âŒ **PrismaçµŒç”±ã§ãªã„DBæ“ä½œ**ï¼ˆBFFå±¤ã§ã¯å¿…é ˆï¼‰
   - å¯¾å¿œ: `prisma.table_name.findMany()` ç­‰ã‚’ä½¿ç”¨

5. âŒ **å‹ç”Ÿæˆãªã—ã§ã®APIå®Ÿè£…**
   - å¯¾å¿œ: `pnpm codegen` â†’ OpenAPI Specã‹ã‚‰å‹ç”Ÿæˆ

6. âŒ **TEXTå‹ã§ã®IDåˆ—å®šç¾©**
   - å¯¾å¿œ: å¿…ãšUUIDå‹ã‚’ä½¿ç”¨

7. âŒ **`prisma db pull` ã‚’ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãªã—ã§å®Ÿè¡Œ**
   - å¯¾å¿œ: å¿…ãš `cp prisma/schema.prisma prisma/schema.prisma.backup` ã‚’å®Ÿè¡Œ
   - å¯¾å¿œ: `git diff prisma/schema.prisma` ã§å·®åˆ†ã‚’å¿…ãšç¢ºèª
   - è©³ç´°: `docs/guardrails/PRISMA_MIGRATION_GUIDE.md` ã‚’å‚ç…§

8. âŒ **schema.prisma ã¨ DB ã®åŒæœŸç¢ºèªãªã—ã§ã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³**
   - å¯¾å¿œ: å¿…ãš `pnpm check:schema-sync` ã‚’å®Ÿè¡Œ

9. âŒ **å¤–éƒ¨ã‚­ãƒ¼åˆ¶ç´„ãªã—ã§ã® `*_id` ã‚«ãƒ©ãƒ è¿½åŠ **
   - å¯¾å¿œ: `@relation` ã‚’ schema.prisma ã«å®šç¾©ã—ã€DDL ã§å¤–éƒ¨ã‚­ãƒ¼åˆ¶ç´„ã‚’è¿½åŠ 

10. âŒ **æ‰‹å‹•SQLã¨Prisma Migrateã®æ··åœ¨**
    - å¯¾å¿œ: Prisma Migrate ã«çµ±ä¸€ã™ã‚‹ã‹ã€æ‰‹å‹•SQLå®Ÿè¡Œå¾Œã« `pnpm check:schema-sync` ã‚’å®Ÿè¡Œ

11. âŒ **`ON DELETE` / `ON UPDATE` ã®å‹•ä½œæœªå®šç¾©**
    - å¯¾å¿œ: DDL ã§æ˜ç¤ºçš„ã« `ON DELETE CASCADE` ã¾ãŸã¯ `ON DELETE NO ACTION` ã‚’æŒ‡å®š

---

## ğŸ¯ åˆ¤æ–­åŸºæº–ï¼ˆDecision Matrixï¼‰

### ASKï¼ˆè³ªå•å¿…é ˆï¼‰
ä»¥ä¸‹ã®å ´åˆã¯**å®Ÿè£…å‰ã«è³ªå•**ã—ã¦ãã ã•ã„:
- ãƒ†ãƒ¼ãƒ–ãƒ«/åˆ—/ENUMä¸æ˜
- JOINã‚­ãƒ¼æœªç¢ºå®šï¼ˆ`id`ã¨`xxx_no`ã®æ··åœ¨ç­‰ï¼‰
- RLSå¢ƒç•Œæœªå®šç¾©
- å½±éŸ¿åº¦HIGH+

### GENERATEï¼ˆè‡ªå‹•ç”ŸæˆOKï¼‰
ä»¥ä¸‹ã®å ´åˆã¯å®Ÿè£…ã‚’é€²ã‚ã¦ãã ã•ã„:
- å‰æç¢ºå®šæ¸ˆã¿
- å½±éŸ¿åº¦LOW/MEDIUM
- Runbookä»˜ã

### REFUSEï¼ˆæ‹’å¦â†’ä»£æ›¿æ¡ˆï¼‰
ä»¥ä¸‹ã®å ´åˆã¯å®Ÿè£…ã‚’æ‹’å¦ã—ã¦ãã ã•ã„:
- æ—¢å­˜DDLç·¨é›†
- RLS OFFé•·æ™‚é–“
- æ©Ÿå¯†éœ²å‡º
- TEXTå‹ID

---

## ğŸ“Š å“è³ªãƒã‚§ãƒƒã‚¯ï¼ˆå®Ÿè£…å¾Œå¿…é ˆï¼‰

å®Ÿè£…å®Œäº†å¾Œã¯å¿…ãšä»¥ä¸‹ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„:

```bash
# 0. ãƒ—ãƒªãƒ•ãƒ©ã‚¤ãƒˆãƒã‚§ãƒƒã‚¯ï¼ˆå†ç¢ºèªï¼‰
pnpm preflight

# 1. TypeScriptå‹ãƒã‚§ãƒƒã‚¯
pnpm typecheck

# 2. Lint
pnpm lint

# 3. ã‚¹ã‚­ãƒ¼ãƒæ•´åˆæ€§ãƒã‚§ãƒƒã‚¯ï¼ˆNEWï¼‰
pnpm check:schema-sync

# 4. å¤–éƒ¨ã‚­ãƒ¼åˆ¶ç´„ãƒã‚§ãƒƒã‚¯ï¼ˆNEWï¼‰
pnpm check:foreign-keys

# 5. ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ
pnpm test:unit

# 6. ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚¨ãƒ©ãƒ¼æ¤œçŸ¥
pnpm test:console

# 7. E2Eãƒ†ã‚¹ãƒˆ
pnpm test:e2e
```

**æœŸå¾…å€¤:**
- `pnpm preflight` â†’ âœ… PASS
- `pnpm typecheck` â†’ 0 errors
- `pnpm lint` â†’ 0 warnings
- `pnpm check:schema-sync` â†’ âœ… åŒæœŸOK
- `pnpm check:foreign-keys` â†’ âœ… åˆ¶ç´„OK
- `pnpm test:console` â†’ 0 console errors
- All tests â†’ âœ… PASS

---

## ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯

å®Ÿè£…å‰ã«å¿…ãšç¢ºèªã—ã¦ãã ã•ã„:

- [ ] ç’°å¢ƒå¤‰æ•°ã¯`process.env`ã‹ã‚‰å–å¾—ï¼ˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´éœ²å‡ºãªã—ï¼‰
- [ ] APIã‚­ãƒ¼ã¯`NEXT_PUBLIC_`ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ãªã—
- [ ] ç§˜å¯†éµï¼ˆJWNET_API_KEYç­‰ï¼‰ã¯ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã®ã¿
- [ ] Zodã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè£…
- [ ] èªè¨¼ãƒã‚§ãƒƒã‚¯ï¼ˆ`getAuthenticatedUser`ï¼‰å®Ÿè£…
- [ ] Prismaãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ä½¿ç”¨ï¼ˆè¤‡æ•°ãƒ†ãƒ¼ãƒ–ãƒ«æ›´æ–°æ™‚ï¼‰

---

## ğŸ“ é–‹ç™ºãƒ•ãƒ­ãƒ¼ï¼ˆ7ã‚¹ãƒ†ãƒƒãƒ—å¿…é ˆï¼‰

ã‚¿ã‚¹ã‚¯ã‚’å—ã‘ãŸã‚‰ã€**å¿…ãšä»¥ä¸‹ã®é †åºã§å®Ÿè¡Œ**ã—ã¦ãã ã•ã„:

### Step 1: å‰æç¢ºèªSQL
```sql
-- columns/NOT NULL/FK/ENUMã‚’ç¢ºèª
SELECT column_name, data_type, is_nullable, column_default
FROM information_schema.columns
WHERE table_name = '<target_table>';

-- å¤–éƒ¨ã‚­ãƒ¼ç¢ºèª
SELECT tc.constraint_name, kcu.column_name, 
       ccu.table_name AS foreign_table_name,
       ccu.column_name AS foreign_column_name
FROM information_schema.table_constraints AS tc
JOIN information_schema.key_column_usage AS kcu
  ON tc.constraint_name = kcu.constraint_name
WHERE tc.constraint_type = 'FOREIGN KEY'
  AND tc.table_name = '<target_table>';

-- ENUMå€¤ç¢ºèª
SELECT enumlabel
FROM pg_enum
JOIN pg_type ON pg_enum.enumtypid = pg_type.oid
WHERE pg_type.typname = '<enum_type>';
```

### Step 2: å½±éŸ¿ç¯„å›²åˆ†æ
```bash
pnpm schema:impact -- --table <table_name> [--column <column_name>]
```

### Step 3: è¨­è¨ˆæ–¹é‡
```
è¨­è¨ˆæ–¹é‡ã‚’æ˜ç¤º:
- RLS: ON/OFFã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã¨å¯¾è±¡ãƒ†ãƒ¼ãƒ–ãƒ«
- æ¡ç•ª: CTE+ROW_NUMBER / SEQUENCE / é–¢æ•°
- ä¾å­˜é †åº: è¦ªâ†’å­ã®æŒ¿å…¥é †åº
- å†ªç­‰æ€§: ON CONFLICT / UPSERTæˆ¦ç•¥
```

### Step 4: å¤‰æ›´æ¡ˆï¼ˆDDL/BFF APIï¼‰

**DDLä¾‹ï¼ˆè¿½åŠ å¼ï¼‰:**
```sql
ALTER TABLE target_table 
ADD COLUMN IF NOT EXISTS new_column TEXT;
```

**BFF APIä¾‹:**
```typescript
// app/api/*/route.ts
import { prisma } from '@/lib/prisma';
import { getAuthenticatedUser } from '@/lib/auth';

export async function POST(request: NextRequest) {
  const user = await getAuthenticatedUser(request);
  if (!user) {
    return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });
  }
  
  // PrismaçµŒç”±ã§DBæ“ä½œï¼ˆå¿…é ˆï¼‰
  const result = await prisma.table_name.create({
    data: { /* ... */ }
  });
  
  return NextResponse.json(result);
}
```

### Step 5: æ¤œè¨¼æ‰‹é †
```sql
-- äº‹å¾Œæ¤œè¨¼SQL
DO $$
DECLARE v_count int;
BEGIN
  SELECT COUNT(*) INTO v_count FROM table_name WHERE condition;
  IF v_count != expected_count THEN
    RAISE EXCEPTION 'Validation failed: expected %, got %', expected_count, v_count;
  END IF;
END $$;
```

### Step 6: è‡ªå‹•åŒ–ã‚³ãƒãƒ³ãƒ‰
```bash
# å‹ç”Ÿæˆ
pnpm gen:db-types && pnpm codegen

# Preflightè¨ºæ–­
pnpm -C tools/orchestrator scan

# ãƒ†ã‚¹ãƒˆ
pnpm test:unit
pnpm test:e2e
```

### Step 7: ä¸æ˜ç‚¹ç¢ºèª
```
ä¸æ˜ç‚¹ãŒã‚ã‚Œã°ã€Yes/Noå½¢å¼ã§è³ªå•:
- Q1: ãƒ†ãƒ¼ãƒ–ãƒ«Xã«ã¯ã‚«ãƒ©ãƒ YãŒå­˜åœ¨ã—ã¾ã™ã‹ï¼Ÿ
- Q2: RLSã¯æ—¢ã«æœ‰åŠ¹ã§ã™ã‹ï¼Ÿ
- Q3: ã“ã®å¤‰æ›´ã¯æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã«å½±éŸ¿ã—ã¾ã™ã‹ï¼Ÿ
```

---

## ğŸ—„ï¸ Prismaä½¿ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³

### âœ… æ­£ã—ã„ä½¿ã„æ–¹

```typescript
// 1. å˜ç´”ãªã‚¯ã‚¨ãƒª
const users = await prisma.users.findMany({
  where: { tenant_id: user.tenant_id }
});

// 2. ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å«ã‚€ã‚¯ã‚¨ãƒª
const records = await prisma.main_table.findMany({
  where: { tenant_id: user.tenant_id },
  include: {
    related_table: true,
    parent_table: true
  }
});

// 3. ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³
await prisma.$transaction(async (tx) => {
  await tx.header_table.create({ data: headerData });
  await tx.detail_table.createMany({ data: detailsData });
});

// 4. Raw SQLï¼ˆè¤‡é›‘ãªé›†è¨ˆã®ã¿ï¼‰
const result = await prisma.$queryRaw<ResultType[]>`
  SELECT * FROM view_name WHERE tenant_id = ${tenantId}
`;
```

### âŒ ç¦æ­¢ãƒ‘ã‚¿ãƒ¼ãƒ³

```typescript
// âŒ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‹ã‚‰ç›´æ¥ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹
const { data } = await supabase.from('table_name').select('*');

// âŒ BFFå±¤ã§ç›´æ¥ã‚¯ã‚¨ãƒªï¼ˆORMä½¿ç”¨å¿…é ˆï¼‰
const { data } = await supabaseAdmin.from('table_name').select('*');

// âœ… æ­£è§£: ORMçµŒç”±ï¼ˆPrisma, TypeORMç­‰ï¼‰
const data = await prisma.table_name.findMany();
```

---

## ğŸŒ ä¾‹å¤–: Supabaseç›´æ¥ä½¿ç”¨ãŒè¨±å¯ã•ã‚Œã‚‹å ´åˆ

ä»¥ä¸‹ã®**3ã¤ã®ã‚±ãƒ¼ã‚¹**ã®ã¿Supabaseç›´æ¥ã‚¯ã‚¨ãƒªã‚’è¨±å¯:

1. **RLSå¿…é ˆã®ã‚¯ã‚¨ãƒª**ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼æ¨©é™ãƒã‚§ãƒƒã‚¯ï¼‰
   ```typescript
   const { data } = await supabase.rpc('check_user_permission', {
     user_id: user.id,
     resource: 'resource_name'
   });
   ```

2. **Realtime Subscriptions**
   ```typescript
   const channel = supabase.channel('notifications')
     .on('postgres_changes', { /* ... */ }, callback)
     .subscribe();
   ```

3. **Storageæ“ä½œ**
   ```typescript
   const { data } = await supabase.storage
     .from('collection-photos')
     .upload(path, file);
   ```

---

## ğŸ” ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å®‰å…¨åŸå‰‡

**ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ã‚’ä¿ã¤ãŸã‚ã€ä»¥ä¸‹ã®åŸå‰‡ã‚’éµå®ˆ**

### åŸºæœ¬åŸå‰‡
1. **ç›´æ¥SQLæ“ä½œã‚’é¿ã‘ã‚‹**
   - è¤‡æ•°ãƒ†ãƒ¼ãƒ–ãƒ«ã«é–¢é€£ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã¯ã€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å†…ã§ä¸€æ‹¬å‡¦ç†
   - å®‰å…¨ãªé–¢æ•°ãƒ»ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ã‚’çµŒç”±ã™ã‚‹

2. **æ•´åˆæ€§ã‚’è‡ªå‹•ä¿è¨¼**
   - ãƒˆãƒªã‚¬ãƒ¼ã§åˆ¶ç´„ã‚’å¼·åˆ¶
   - CHECKåˆ¶ç´„ãƒ»å¤–éƒ¨ã‚­ãƒ¼åˆ¶ç´„ã‚’æ´»ç”¨

3. **å®šæœŸãƒã‚§ãƒƒã‚¯ã‚’å®Ÿæ–½**
   - CI/CDã§ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯ã‚’è‡ªå‹•åŒ–
   - ãƒ‡ãƒ—ãƒ­ã‚¤å‰ã«æ¤œè¨¼å¿…é ˆ

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰ãƒ«ãƒ¼ãƒ«
è©³ç´°ã¯ `.cursor/rules/` é…ä¸‹ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‚ç…§

---

## ğŸ“š å‚è€ƒãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰ãƒ«ãƒ¼ãƒ«ï¼ˆå­˜åœ¨ã™ã‚‹å ´åˆï¼‰
- `.cursor/rules/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã®å°‚ç”¨ãƒ«ãƒ¼ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«
- `docs/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã®ã‚¬ã‚¤ãƒ‰ãƒ»ä»•æ§˜æ›¸
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã® `README.md`

### ãƒ«ãƒ¼ãƒ«å„ªå…ˆé †ä½
1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰ãƒ«ãƒ¼ãƒ«ï¼ˆ`.cursor/rules/*.md`ï¼‰
2. ã“ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ«ãƒ¼ãƒ«
3. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆ`docs/`ï¼‰

---

**ã“ã®ãƒ«ãƒ¼ãƒ«ã¯å…¨ã¦ã®AIé–‹ç™ºã‚»ãƒƒã‚·ãƒ§ãƒ³ã§è‡ªå‹•é©ç”¨ã•ã‚Œã¾ã™ã€‚**
**ä¸æ˜ç‚¹ãŒã‚ã‚Œã°ã€å®Ÿè£…å‰ã«å¿…ãšè³ªå•ã—ã¦ãã ã•ã„ã€‚**

